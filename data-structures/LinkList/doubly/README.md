# Doubly Linked List

## ğŸ¯ è¨­è¨ˆç†å¿µ

### å­˜åœ¨æ„ç¾©

**é€™å€‹å·¥å…·è¢«ç™¼æ˜å‡ºä¾†ï¼Œæ˜¯ç‚ºäº†è§£æ±ºä»€éº¼é¡å‹çš„å•é¡Œï¼Ÿ**

| é¢å‘           | èªªæ˜                                                                                               |
| -------------- | -------------------------------------------------------------------------------------------------- |
| **ç—›é»**       | Singly Linked List åªèƒ½å–®å‘éæ­·ï¼Œç•¶éœ€è¦ã€Œå›åˆ°å‰ä¸€å€‹ç¯€é»ã€æ™‚ï¼Œå¿…é ˆå¾ head é‡æ–°èµ°ä¸€éï¼Œæ™‚é–“æˆæœ¬ O(n) |
| **åƒ¹å€¼ä¸»å¼µ**   | ä»¥é¡å¤–ä¸€å€‹æŒ‡æ¨™(prev)æ›å–ã€Œé›™å‘ç§»å‹•èƒ½åŠ›ã€ï¼Œè®“åˆªé™¤ä»»æ„å·²çŸ¥ç¯€é»ã€åå‘éæ­·ç­‰æ“ä½œå¾ O(n) é™åˆ° O(1)      |
| **ä¸€å¥è©±æœ¬è³ª** | ç”¨ç©ºé–“æ›æ™‚é–“çš„é›™å‘å°èˆªçµæ§‹â€”â€”ä»»ä½•ç¯€é»éƒ½èƒ½åŒæ™‚çŸ¥é“ã€Œä¾†æ™‚è·¯ã€å’Œã€Œå»è™•ã€                               |

```plaintext
Singly: head â†’ [A] â†’ [B] â†’ [C] â†’ null
        (å¾ C æƒ³å›åˆ° Bï¼Ÿå¿…é ˆå¾ head é‡èµ°)

Doubly: null â† [A] â‡„ [B] â‡„ [C] â†’ null
        (C.prev ç›´æ¥æ‹¿åˆ° Bï¼ŒO(1))
```

### å¿ƒæ™ºæ¨¡å‹

**é¡æ¯”ï¼šåœ°éµé›™å‘è»Œé“**

| æ“ä½œ        | é¡æ¯”èªªæ˜                                         |
| ----------- | ------------------------------------------------ |
| `node.next` | å¾€ä¸‹ä¸€ç«™çš„è»Œé“                                   |
| `node.prev` | å¾€ä¸Šä¸€ç«™çš„è»Œé“                                   |
| æ’å…¥ç¯€é»    | åœ¨å…©ç«™ä¹‹é–“æ–°å¢ä¸€ç«™ï¼Œéœ€è¦åŒæ™‚æ¥å¥½ã€Œä¾†å›ã€å…©æ¢è»Œé“ |
| åˆªé™¤ç¯€é»    | æ‹†é™¤ä¸€ç«™ï¼Œè®“å‰å¾Œå…©ç«™ç›´æ¥ç›¸é€£(é›™å‘éƒ½è¦æ¥)         |
| éæ­·        | å¯ä»¥å¾ä»»æ„ç«™å‡ºç™¼ï¼Œå¾€ä»»ä¸€æ–¹å‘èµ°                   |

**âš ï¸ é¡æ¯”å±€é™**ï¼šçœŸå¯¦åœ°éµè»Œé“æ˜¯ç‰©ç†å­˜åœ¨çš„ï¼Œè€Œ Linked List çš„ã€Œé€£æ¥ã€åªæ˜¯è¨˜æ†¶é«”ä½å€çš„å¼•ç”¨ã€‚åˆªé™¤ç¯€é»å¾Œï¼Œè©²è¨˜æ†¶é«”å¯èƒ½è¢«å…¶ä»–è³‡æ–™è¦†å¯«ã€‚

---

## ğŸ—ï¸ æŠ½è±¡çµæ§‹

### æ ¸å¿ƒçµ„ä»¶

| çµ„ä»¶       | åŠŸèƒ½             | ç‚ºä»€éº¼éœ€è¦                         |
| ---------- | ---------------- | ---------------------------------- |
| `ListNode` | å„²å­˜å€¼èˆ‡é›™å‘æŒ‡æ¨™ | è³‡æ–™çš„æœ€å°å–®ä½ï¼Œéœ€åŒæ™‚è¨˜éŒ„å‰å¾Œé€£æ¥ |
| `head`     | æŒ‡å‘ç¬¬ä¸€å€‹ç¯€é»   | O(1) å­˜å–èµ·é»ï¼Œæ”¯æ´ prepend/shift  |
| `tail`     | æŒ‡å‘æœ€å¾Œä¸€å€‹ç¯€é» | O(1) å­˜å–çµ‚é»ï¼Œæ”¯æ´ append/pop     |
| `length`   | è¨˜éŒ„ç¯€é»æ•¸é‡     | O(1) å–å¾—é•·åº¦ï¼Œé¿å…æ¯æ¬¡éæ­·è¨ˆæ•¸    |

### ç‹€æ…‹è¡¨ç¤º

```javascript
class ListNode {
  constructor(value) {
    this.value = value;
    this.prev = null; // â† é€™æ˜¯ Doubly çš„é—œéµå·®ç•°
    this.next = null;
  }
}
```

**åˆå§‹ç‹€æ…‹**(ç©ºä¸²åˆ—)ï¼š

```plaintext
head = null
tail = null
length = 0
```

**å–®ä¸€ç¯€é»ç‹€æ…‹**ï¼š

```plaintext
head â”€â”€â†’ [A] â†â”€â”€ tail
         prev: null
         next: null
```

**å¤šç¯€é»ç‹€æ…‹**ï¼š

```plaintext
head â”€â”€â†’ [A] â‡„ [B] â‡„ [C] â†â”€â”€ tail
         â†‘               â†‘
    prev:null       next:null
```

### ä¸è®Šé‡(Invariants)

é€™äº›æ˜¯ä»»ä½•æ“ä½œå‰å¾Œéƒ½å¿…é ˆç¶­æŒçš„æ€§è³ªï¼š

| ä¸è®Šé‡           | èªªæ˜                                        | é•åå¾Œæœ                      |
| ---------------- | ------------------------------------------- | ----------------------------- |
| **é›™å‘ä¸€è‡´æ€§**   | è‹¥ `A.next === B`ï¼Œå‰‡ `B.prev === A`        | éæ­·æ–¹å‘ä¸åŒæœƒå¾—åˆ°ä¸åŒçµæœ    |
| **é‚Šç•Œæ­£ç¢ºæ€§**   | `head.prev === null`ï¼Œ`tail.next === null`  | éæ­·ä¸æœƒæ­£ç¢ºçµ‚æ­¢              |
| **é•·åº¦åŒæ­¥**     | `length` å¿…é ˆç­‰æ–¼å¯¦éš›ç¯€é»æ•¸                 | `getNode(index)` é‚Šç•Œæª¢æŸ¥å¤±æ•ˆ |
| **ç©ºä¸²åˆ—ä¸€è‡´æ€§** | `length === 0` æ™‚ï¼Œ`head === tail === null` | å­˜å–ç©ºä¸²åˆ—æœƒå‡ºéŒ¯              |

---

### æ ¸å¿ƒæ“ä½œ

#### 1. append(value) â€” å°¾éƒ¨æ’å…¥

**ç›®çš„**ï¼šåœ¨ä¸²åˆ—å°¾ç«¯æ–°å¢ç¯€é»

**è¼¸å…¥/è¼¸å‡º**ï¼š`value` â†’ `this`(æ”¯æ´éˆå¼å‘¼å«)

**ä¸è®Šé‡ç¶­è­·**ï¼š

- æ–°ç¯€é»æˆç‚º tail
- åŸ tail çš„ next æŒ‡å‘æ–°ç¯€é»
- æ–°ç¯€é»çš„ prev æŒ‡å‘åŸ tail
- length å¢åŠ  1

**åŸºç¤å¯¦ä½œ**ï¼š

```javascript
/**
 * åœ¨ä¸²åˆ—å°¾éƒ¨æ’å…¥æ–°ç¯€é»
 * @param {*} value - è¦æ’å…¥çš„å€¼
 * @return {DoublyLinkedList} - this(æ”¯æ´éˆå¼å‘¼å«)
 *
 * æ™‚é–“è¤‡é›œåº¦ï¼šO(1) - ç›´æ¥é€é tail æŒ‡æ¨™å­˜å–
 * ç©ºé–“è¤‡é›œåº¦ï¼šO(1) - åªå»ºç«‹ä¸€å€‹æ–°ç¯€é»
 */
append(value) {
  const node = new ListNode(value);

  // Base caseï¼šç©ºä¸²åˆ—
  if (!this.head) {
    this.head = node;
    this.tail = node;
    this.length++;
    return this;
  }

  // å»ºç«‹é›™å‘é€£æ¥(é€™æ˜¯ Doubly çš„æ ¸å¿ƒ)
  // é—œéµï¼šå¿…é ˆåŒæ™‚è¨­å®š next å’Œ prevï¼Œé †åºä¸å½±éŸ¿æ­£ç¢ºæ€§ä½†å»ºè­°çµ±ä¸€
  this.tail.next = node;  // åŸ tail æŒ‡å‘æ–°ç¯€é»
  node.prev = this.tail;  // æ–°ç¯€é»å›æŒ‡åŸ tail
  this.tail = node;       // æ›´æ–° tail æŒ‡æ¨™
  this.length++;

  return this;
}
```

**è¦–è¦ºåŒ–**ï¼š

```plaintext
Before: head â†’ [A] â‡„ [B] â† tail

Step 1: Create [C]
Step 2: [B].next = [C]     â†’  [A] â‡„ [B] â†’ [C]
Step 3: [C].prev = [B]     â†’  [A] â‡„ [B] â‡„ [C]
Step 4: tail = [C]

After:  head â†’ [A] â‡„ [B] â‡„ [C] â† tail
```

---

#### 2. prepend(value) â€” é ­éƒ¨æ’å…¥

**ç›®çš„**ï¼šåœ¨ä¸²åˆ—é–‹é ­æ–°å¢ç¯€é»

**èˆ‡ Singly çš„å·®ç•°**ï¼šéœ€è¦é¡å¤–è¨­å®šåŸ head çš„ prev

```javascript
/**
 * åœ¨ä¸²åˆ—é ­éƒ¨æ’å…¥æ–°ç¯€é»
 * @param {*} value - è¦æ’å…¥çš„å€¼
 * @return {DoublyLinkedList} - this
 *
 * æ™‚é–“è¤‡é›œåº¦ï¼šO(1)
 * ç©ºé–“è¤‡é›œåº¦ï¼šO(1)
 */
prepend(value) {
  const node = new ListNode(value);

  if (!this.head) {
    this.head = node;
    this.tail = node;
    this.length++;
    return this;
  }

  // é—œéµå·®ç•°ï¼šSingly åªéœ€è¨­å®š node.next = head
  // Doubly é‚„éœ€è¦è¨­å®š head.prev = node
  node.next = this.head;
  this.head.prev = node;  // â† Doubly ç‰¹æœ‰
  this.head = node;
  this.length++;

  return this;
}
```

---

#### 3. getNode(index) â€” éš¨æ©Ÿå­˜å–

**ç›®çš„**ï¼šå–å¾—æŒ‡å®šä½ç½®çš„ç¯€é»

**åŸºç¤ç‰ˆæœ¬çš„å•é¡Œ**ï¼šå¾ head ç·šæ€§éæ­·ï¼Œæœ€å£ O(n)

**å„ªåŒ–ç­–ç•¥ï¼šé›™å‘æœå°‹**

| æ¢ä»¶                  | ç­–ç•¥           | åŸå›            |
| --------------------- | -------------- | -------------- |
| `index < length / 2`  | å¾ head å¾€å¾Œæ‰¾ | è·é›¢ head è¼ƒè¿‘ |
| `index >= length / 2` | å¾ tail å¾€å‰æ‰¾ | è·é›¢ tail è¼ƒè¿‘ |

```javascript
/**
 * å–å¾—æŒ‡å®šç´¢å¼•çš„ç¯€é»
 * @param {number} index - ç›®æ¨™ç´¢å¼•(0-based)
 * @return {ListNode|null} - ç›®æ¨™ç¯€é»æˆ– null
 *
 * å„ªåŒ–æŠ€å·§ï¼šé›™å‘æœå°‹(Bidirectional Search)
 * æ ¸å¿ƒæ€æƒ³ï¼šåˆ©ç”¨ Doubly çš„é›™å‘ç‰¹æ€§ï¼Œå¾è¼ƒè¿‘çš„ç«¯é»é–‹å§‹æœå°‹
 *
 * æ™‚é–“è¤‡é›œåº¦ï¼šO(n/2) = O(n)ï¼Œä½†å¸¸æ•¸å› å­æ¸›åŠ
 * ç©ºé–“è¤‡é›œåº¦ï¼šO(1)
 */
getNode(index) {
  // é‚Šç•Œæª¢æŸ¥ï¼šä½¿ç”¨ length ä¸è®Šé‡
  if (index < 0 || index >= this.length) return null;

  // å¿«é€Ÿè·¯å¾‘ï¼šç›´æ¥è¿”å›é ­å°¾
  if (index === 0) return this.head;
  if (index === this.length - 1) return this.tail;

  // å„ªåŒ–ï¼šåˆ¤æ–·å¾å“ªç«¯é–‹å§‹è¼ƒè¿‘
  const searchFromHead = index < this.length / 2;

  if (searchFromHead) {
    let current = this.head;
    for (let i = 0; i < index; i++) {
      current = current.next;
    }
    return current;
  } else {
    // å¾ tail å¾€å‰æ‰¾ï¼Œé€™æ˜¯ Doubly æ‰èƒ½åšåˆ°çš„å„ªåŒ–
    let current = this.tail;
    for (let i = this.length - 1; i > index; i--) {
      current = current.prev;
    }
    return current;
  }
}
```

**è¤‡é›œåº¦åˆ†æ**ï¼š

- **Singly**ï¼šæ°¸é  O(n)(åªèƒ½å¾ head é–‹å§‹)
- **Doubly**ï¼šæœ€å£ O(n/2)(é¸è¼ƒè¿‘çš„ç«¯é»)
- **å¯¦éš›æ•ˆç›Š**ï¼šç•¶ `index` æ¥è¿‘ `length - 1` æ™‚ï¼ŒSingly éœ€è¦èµ°å®Œæ•´æ¢ä¸²åˆ—ï¼ŒDoubly åªéœ€èµ°å¹¾æ­¥

---

#### 4. remove(index) â€” åˆªé™¤ç¯€é»

**ç›®çš„**ï¼šåˆªé™¤æŒ‡å®šä½ç½®çš„ç¯€é»

**é€™æ˜¯ Doubly æœ€å¤§åƒ¹å€¼é«”ç¾çš„æ“ä½œ**

| æƒ…å¢ƒ                 | Singly è¤‡é›œåº¦ | Doubly è¤‡é›œåº¦ | åŸå›                     |
| -------------------- | ------------- | ------------- | ----------------------- |
| åˆªé™¤ head            | O(1)          | O(1)          | å…©è€…éƒ½ç›´æ¥æ“ä½œ          |
| åˆªé™¤ tail            | **O(n)**      | **O(1)**      | Singly éœ€è¦æ‰¾å‰ä¸€å€‹ç¯€é» |
| åˆªé™¤ä¸­é–“(å·²çŸ¥ç¯€é»)   | O(n)          | O(1)          | Singly éœ€è¦æ‰¾ prev      |
| åˆªé™¤ä¸­é–“(åªçŸ¥ index) | O(n)          | O(n)          | éƒ½éœ€è¦å…ˆæ‰¾åˆ°ç¯€é»        |

```javascript
/**
 * åˆªé™¤æŒ‡å®šç´¢å¼•çš„ç¯€é»
 * @param {number} index - è¦åˆªé™¤çš„ç´¢å¼•
 * @return {*} - è¢«åˆªé™¤ç¯€é»çš„å€¼ï¼Œæˆ– undefined
 *
 * æ™‚é–“è¤‡é›œåº¦ï¼šO(n) æ‰¾ç¯€é» + O(1) åˆªé™¤ = O(n)
 * ç©ºé–“è¤‡é›œåº¦ï¼šO(1)
 *
 * æ³¨æ„ï¼šè‹¥å·²æŒæœ‰ç¯€é»å¼•ç”¨ï¼Œå¯ç›´æ¥ O(1) åˆªé™¤(è¦‹ removeNode æ–¹æ³•)
 */
remove(index) {
  if (index < 0 || index >= this.length) return undefined;

  // Case 1ï¼šåˆªé™¤ head
  if (index === 0) {
    const removed = this.head;
    this.head = this.head.next;
    if (this.head) {
      this.head.prev = null;  // ç¶­è­·é‚Šç•Œä¸è®Šé‡
    } else {
      this.tail = null;  // ä¸²åˆ—è®Šç©º
    }
    this.length--;
    return removed.value;
  }

  // Case 2ï¼šåˆªé™¤ tail(Doubly çš„å„ªå‹¢)
  if (index === this.length - 1) {
    const removed = this.tail;
    this.tail = this.tail.prev;  // O(1) å–å¾—å‰ä¸€ç¯€é»ï¼
    this.tail.next = null;
    this.length--;
    return removed.value;
  }

  // Case 3ï¼šåˆªé™¤ä¸­é–“ç¯€é»
  const target = this.getNode(index);  // O(n/2)
  // é—œéµï¼šé‡æ–°é€£æ¥å‰å¾Œç¯€é»(è·³é target)
  target.prev.next = target.next;
  target.next.prev = target.prev;
  this.length--;

  return target.value;
}
```

**è¦–è¦ºåŒ–åˆªé™¤ä¸­é–“ç¯€é»**ï¼š

```plaintext
Before: [A] â‡„ [B] â‡„ [C]
        åˆªé™¤ [B]

Step 1: [A].next = [C]    â†’  [A] â†’ [C]
                              â†– [B] â†—
Step 2: [C].prev = [A]    â†’  [A] â‡„ [C]
                              (B è¢«å­¤ç«‹)

After:  [A] â‡„ [C]
```

---

#### 5. removeNode(node) â€” O(1) åˆªé™¤å·²çŸ¥ç¯€é»

**é€™æ˜¯ Doubly Linked List çš„æ®ºæ‰‹ç´šåŠŸèƒ½**

ç•¶ä½ å·²ç¶“æŒæœ‰ç¯€é»å¼•ç”¨æ™‚(ä¾‹å¦‚é€é HashMap å¿«å–)ï¼Œå¯ä»¥ O(1) ç›´æ¥åˆªé™¤ï¼š

```javascript
/**
 * ç›´æ¥åˆªé™¤å·²çŸ¥ç¯€é»(ä¸éœ€è¦ index)
 * @param {ListNode} node - è¦åˆªé™¤çš„ç¯€é»
 * @return {*} - è¢«åˆªé™¤ç¯€é»çš„å€¼
 *
 * å‰æï¼šnode å¿…é ˆæ˜¯æ­¤ä¸²åˆ—çš„æˆå“¡
 *
 * æ™‚é–“è¤‡é›œåº¦ï¼šO(1) â† é€™æ˜¯ Doubly æœ€å¼·å¤§çš„åœ°æ–¹
 * ç©ºé–“è¤‡é›œåº¦ï¼šO(1)
 */
removeNode(node) {
  if (!node) return undefined;

  // æ›´æ–°å‰ç¯€é»çš„ next
  if (node.prev) {
    node.prev.next = node.next;
  } else {
    this.head = node.next;  // node æ˜¯ head
  }

  // æ›´æ–°å¾Œç¯€é»çš„ prev
  if (node.next) {
    node.next.prev = node.prev;
  } else {
    this.tail = node.prev;  // node æ˜¯ tail
  }

  this.length--;
  return node.value;
}
```

**ä½¿ç”¨å ´æ™¯**ï¼š

- **LRU Cache**ï¼šHashMap å­˜ key â†’ node æ˜ å°„ï¼Œåˆªé™¤æ™‚ O(1)
- **Task Scheduler**ï¼šç›´æ¥ç§»é™¤å·²å®Œæˆçš„ä»»å‹™ç¯€é»
- **Browser History**ï¼šå¿«é€Ÿåˆªé™¤ç‰¹å®šæ­·å²è¨˜éŒ„

---

### æ ¸å¿ƒæ“ä½œè¤‡é›œåº¦ç¸½çµ

| æ“ä½œ                 | æ™‚é–“è¤‡é›œåº¦ | ç©ºé–“è¤‡é›œåº¦ | vs Singly    | å‚™è¨»             |
| -------------------- | ---------- | ---------- | ------------ | ---------------- |
| **å­˜å–**             |            |            |              |                  |
| getNode(i)           | O(n/2)     | O(1)       | â¬†ï¸ 2x faster | é›™å‘æœå°‹å„ªåŒ–     |
| **æ’å…¥**             |            |            |              |                  |
| append(val)          | O(1)       | O(1)       | =            | éƒ½æœ‰ tail æŒ‡æ¨™   |
| prepend(val)         | O(1)       | O(1)       | =            | éœ€å¤šè¨­ head.prev |
| insertAt(i, val)     | O(n/2)     | O(1)       | â¬†ï¸           | æ‰¾ä½ç½®è¼ƒå¿«       |
| **åˆªé™¤**             |            |            |              |                  |
| shift()              | O(1)       | O(1)       | =            | åˆªé™¤ head        |
| **pop()**            | **O(1)**   | O(1)       | **â¬†ï¸ nâ†’1**   | Doubly æ ¸å¿ƒå„ªå‹¢  |
| remove(i)            | O(n/2)     | O(1)       | â¬†ï¸           | æ‰¾ä½ç½®è¼ƒå¿«       |
| **removeNode(node)** | **O(1)**   | O(1)       | **â¬†ï¸ nâ†’1**   | Doubly æ®ºæ‰‹åŠŸèƒ½  |

**ç¬¦è™Ÿå®šç¾©**ï¼š

- `n`ï¼šä¸²åˆ—é•·åº¦(ç¯€é»æ•¸é‡)

**çµæ§‹æœ¬èº«çš„ç©ºé–“è¤‡é›œåº¦**ï¼šO(n)ï¼Œæ¯å€‹ç¯€é»é¡å¤–å­˜ä¸€å€‹ prev æŒ‡æ¨™(ç›¸æ¯” Singly å¤š ~50% ç©ºé–“)

---

## â­ æŠ½è±¡åŒ–ç¿»è­¯å™¨

### è­˜åˆ¥æ ¸å¿ƒæŠ½è±¡

> **é€™å€‹å·¥å…·çš„æ ¸å¿ƒå°è±¡æ˜¯**ï¼šæœ‰åºçš„ç¯€é»åºåˆ—
>
> **å®ƒç®¡ç†çš„æ˜¯é€™äº›å°è±¡ä¹‹é–“çš„**ï¼šé›™å‘çš„å‰å¾Œé—œä¿‚(predecessor-successor)

### å»ºç«‹æ˜ å°„ç¶­åº¦

| ç¶­åº¦                   | è¦å›ç­”çš„å•é¡Œ                   | é€™å€‹ç­”æ¡ˆæ±ºå®šäº†ä»€éº¼       |
| ---------------------- | ------------------------------ | ------------------------ |
| **ç¶­åº¦ 1ï¼šåˆªé™¤æ¨¡å¼**   | éœ€è¦ O(1) åˆªé™¤ä»»æ„å·²çŸ¥ç¯€é»å—ï¼Ÿ | æ˜¯ â†’ å¿…é ˆç”¨ Doubly       |
| **ç¶­åº¦ 2ï¼šéæ­·æ–¹å‘**   | éœ€è¦åå‘éæ­·å—ï¼Ÿ               | æ˜¯ â†’ Doubly æœ‰å„ªå‹¢       |
| **ç¶­åº¦ 3ï¼šæ“ä½œä½ç½®**   | ä¸»è¦æ“ä½œåœ¨é ­å°¾é‚„æ˜¯ä¸­é–“ï¼Ÿ       | ä¸­é–“ + å·²çŸ¥ç¯€é» â†’ Doubly |
| **ç¶­åº¦ 4ï¼šç©ºé–“æ•æ„Ÿåº¦** | èƒ½æ¥å—æ¯ç¯€é»å¤šä¸€å€‹æŒ‡æ¨™å—ï¼Ÿ     | å¦ â†’ è€ƒæ…® Singly         |

### å¯¦æˆ°æª¢æŸ¥è¡¨

```plaintext
é¡Œç›®ï¼š_______________

ç¶­åº¦ 1(åˆªé™¤æ¨¡å¼)ï¼šæ˜¯å¦éœ€è¦ O(1) åˆªé™¤å·²çŸ¥ç¯€é»ï¼Ÿ_______________
ç¶­åº¦ 2(éæ­·æ–¹å‘)ï¼šæ˜¯å¦éœ€è¦åå‘éæ­·ï¼Ÿ_______________
ç¶­åº¦ 3(æ“ä½œä½ç½®)ï¼šæ“ä½œé›†ä¸­åœ¨å“ªè£¡ï¼Ÿ_______________
ç¶­åº¦ 4(ç©ºé–“æ•æ„Ÿ)ï¼šç©ºé–“æ˜¯å¦æ˜¯ç“¶é ¸ï¼Ÿ_______________

å¦‚æœéœ€è¦ O(1) åˆªé™¤å·²çŸ¥ç¯€é» â†’ Doubly Linked List
å¦‚æœéœ€è¦åå‘éæ­· â†’ Doubly Linked List
å¦‚æœåªéœ€è¦é ­å°¾æ“ä½œ + ç©ºé–“æ•æ„Ÿ â†’ è€ƒæ…® Singly
```

### æ˜ å°„ç¯„ä¾‹

**é¡Œç›® A**ï¼š[LeetCode 146. LRU Cache](https://leetcode.com/problems/lru-cache/)

| ç¶­åº¦   | å…·é«”å•é¡Œ                     | æŠ½è±¡æ˜ å°„                                       |
| ------ | ---------------------------- | ---------------------------------------------- |
| ç¶­åº¦ 1 | `get` æ™‚éœ€è¦æŠŠç¯€é»ç§»åˆ°æœ€å‰é¢ | éœ€è¦å…ˆåˆªé™¤å†æ’å…¥ â†’ **O(1) åˆªé™¤å·²çŸ¥ç¯€é»æ˜¯é—œéµ** |
| ç¶­åº¦ 2 | ä¸éœ€è¦åå‘éæ­·æ•´æ¢ä¸²åˆ—       | ä¸æ˜¯é¸æ“‡ Doubly çš„ä¸»å›                          |
| ç¶­åº¦ 3 | æ“ä½œåœ¨ä»»æ„ä½ç½®(HashMap å®šä½) | HashMap + Doubly = O(1) æ“ä½œ                   |
| ç¶­åº¦ 4 | Cache é€šå¸¸è¨˜æ†¶é«”å……è¶³         | å¯æ¥å— Doubly çš„é¡å¤–ç©ºé–“                       |

**å¾æ˜ å°„åˆ°å¯¦ä½œçš„é—œéµæ­¥é©Ÿ**ï¼š

1. HashMap å„²å­˜ `key â†’ ListNode` æ˜ å°„
2. Doubly Linked List ç¶­è­·å­˜å–é †åº(æœ€è¿‘å­˜å–åœ¨ head)
3. `get(key)`ï¼šHashMap O(1) æ‰¾åˆ°ç¯€é» â†’ `removeNode(node)` O(1) â†’ `prepend(node)` O(1)
4. `put(key, value)`ï¼šè‹¥å·²å­˜åœ¨å‰‡æ›´æ–°ä¸¦ç§»åˆ° headï¼›è‹¥è¶…éå®¹é‡å‰‡åˆªé™¤ tail

---

## ğŸ” è§¸ç™¼å™¨(æ¨¡å¼è­˜åˆ¥)

### æ­£å‘è§¸ç™¼å™¨

| å±¤ç´š         | ç‰¹å¾µ                            | ç‚ºä»€éº¼é€™å€‹ç‰¹å¾µæŒ‡å‘ Doubly Linked List |
| ------------ | ------------------------------- | ------------------------------------- |
| **é—œéµå­—**   | "LRU"ã€"æœ€è¿‘ä½¿ç”¨"ã€"ç§»å‹•åˆ°å‰é¢" | éœ€è¦ O(1) åˆªé™¤ + é‡æ–°æ’å…¥             |
| **é—œéµå­—**   | "é›™å‘éæ­·"ã€"å‰ä¸€å€‹/å¾Œä¸€å€‹"     | ç›´æ¥éœ€è¦ prev æŒ‡æ¨™                    |
| **çµæ§‹**     | HashMap + æœ‰åºé›†åˆ              | ç¶“å…¸çš„ HashMap + Doubly çµ„åˆ          |
| **ç›®æ¨™**     | O(1) æ’å…¥ã€åˆªé™¤ã€å­˜å–(åŒæ™‚é”æˆ) | Doubly + HashMap æ˜¯å”¯ä¸€é¸æ“‡           |
| **æ“ä½œæ¨¡å¼** | é »ç¹åœ¨ä¸­é–“åˆªé™¤å·²çŸ¥ç¯€é»          | Singly åšä¸åˆ° O(1)                    |

**ä¸€å¥è©±è§¸ç™¼è¦å‰‡**ï¼šç•¶éœ€è¦ **O(1) åˆªé™¤ä»»æ„å·²çŸ¥ç¯€é»** æ™‚ï¼Œé¸æ“‡ Doubly Linked List

### åå‘è§¸ç™¼å™¨

| é™·é˜±æƒ…å¢ƒ           | ç‚ºä»€éº¼ä¸é©ç”¨                 | æ›´å¥½çš„é¸æ“‡     |
| ------------------ | ---------------------------- | -------------- |
| åªéœ€è¦é ­å°¾æ“ä½œ     | ä¸éœ€è¦ prev çš„åŠŸèƒ½ï¼Œæµªè²»ç©ºé–“ | Singly / Deque |
| ç©ºé–“æ¥µåº¦å—é™       | æ¯ç¯€é»å¤š 50% ç©ºé–“é–‹éŠ·        | Singly         |
| éœ€è¦ O(1) éš¨æ©Ÿå­˜å– | Linked List éƒ½æ˜¯ O(n)        | Array          |
| åªéœ€è¦ LIFO/FIFO   | ä¸éœ€è¦ prev                  | Stack / Queue  |

### èˆ‡é¡ä¼¼å·¥å…·çš„æ±ºç­–é»

```plaintext
éœ€è¦æœ‰åºçš„å…ƒç´ é›†åˆ
â”œâ”€â”€ éœ€è¦ O(1) éš¨æ©Ÿå­˜å–(by index)
â”‚   â””â”€â”€ Array / Dynamic Array
â”œâ”€â”€ ä¸»è¦æ“ä½œåœ¨é ­å°¾
â”‚   â”œâ”€â”€ åªæœ‰ä¸€ç«¯æ“ä½œ â†’ Stack (Array-based)
â”‚   â”œâ”€â”€ å…©ç«¯æ“ä½œ â†’ Deque (Array-based æ›´ä½³)
â”‚   â””â”€â”€ éœ€è¦ O(1) åˆªé™¤ä¸­é–“ â†’ Doubly Linked List
â”œâ”€â”€ éœ€è¦ O(1) åˆªé™¤ä»»æ„å·²çŸ¥ç¯€é»
â”‚   â””â”€â”€ Doubly Linked List(å”¯ä¸€é¸æ“‡)
â””â”€â”€ åªéœ€è¦å–®å‘éæ­· + ç©ºé–“æ•æ„Ÿ
    â””â”€â”€ Singly Linked List
```

---

## âš ï¸ æ³¨æ„äº‹é …

### å¸¸è¦‹é™·é˜±

| é™·é˜±               | éŒ¯èª¤å¯«æ³•                   | æ­£ç¢ºå¯«æ³•                             | ç‚ºä»€éº¼                   |
| ------------------ | -------------------------- | ------------------------------------ | ------------------------ |
| **é›™å‘ä¸ä¸€è‡´**     | åªè¨­ `a.next = b`          | åŒæ™‚è¨­ `a.next = b` å’Œ `b.prev = a`  | é•åä¸è®Šé‡ï¼Œåå‘éæ­·éŒ¯èª¤ |
| **åˆªé™¤æ™‚æ¼è¨­**     | åªæ›´æ–° `prev.next`         | åŒæ™‚æ›´æ–° `prev.next` å’Œ `next.prev`  | ç•™ä¸‹æ‡¸ç©ºæŒ‡æ¨™             |
| **ç©ºä¸²åˆ—è™•ç†**     | ç›´æ¥æ“ä½œ `this.head.next`  | å…ˆæª¢æŸ¥ `if (!this.head)`             | NullPointerException     |
| **å–®ç¯€é»é‚Šç•Œ**     | åˆªé™¤å¾Œå¿˜è¨˜è¨­ `tail = null` | åˆªé™¤æœ€å¾Œç¯€é»æ™‚åŒæ­¥æ›´æ–° head å’Œ tail  | ç‹€æ…‹ä¸ä¸€è‡´               |
| **getNode æ–¹å‘éŒ¯** | `index < length/2` å¾ tail | æ­£ç¢ºï¼š`index < length/2` å¾ **head** | é‚è¼¯åäº†æœƒæ›´æ…¢           |

### å¸¸è¦‹è®Šé«”

| è®Šé«”                | ä¿®æ”¹å…§å®¹                               | é©ç”¨å ´æ™¯               |
| ------------------- | -------------------------------------- | ---------------------- |
| **Circular Doubly** | `head.prev = tail`ï¼Œ`tail.next = head` | è¼ªæ’­ã€å¾ªç’°ç·©è¡å€       |
| **Sentinel Node**   | åŠ å…¥è™›æ“¬ head/tail ç¯€é»                | ç°¡åŒ–é‚Šç•Œè™•ç†(LRU å¸¸ç”¨) |
| **XOR Linked List** | ç”¨ `prev XOR next` å­˜å–®ä¸€æŒ‡æ¨™          | æ¥µç«¯ç©ºé–“å„ªåŒ–(å¯¦å‹™ç½•è¦‹) |

---

## ğŸ¯ ç¶“å…¸é¡Œå‹èˆ‡è§£æ³•æ˜ å°„

| é¡Œç›®                                                                                    | æ ¸å¿ƒæ¨¡å¼                        | ç‚ºä»€éº¼ç”¨ Doubly       |
| --------------------------------------------------------------------------------------- | ------------------------------- | --------------------- |
| [146. LRU Cache](https://leetcode.com/problems/lru-cache/)                              | HashMap + Doubly                | O(1) åˆªé™¤ä»»æ„å·²çŸ¥ç¯€é» |
| [460. LFU Cache](https://leetcode.com/problems/lfu-cache/)                              | HashMap + Doubly(per frequency) | åŒä¸Š + é »ç‡åˆ†çµ„       |
| [432. All O'one Data Structure](https://leetcode.com/problems/all-oone-data-structure/) | HashMap + Doubly                | O(1) ç§»å‹•ç¯€é»ä½ç½®     |
| [716. Max Stack](https://leetcode.com/problems/max-stack/)                              | HashMap + Doubly + TreeMap      | O(log n) åˆªé™¤ä»»æ„å€¼   |
| [641. Design Circular Deque](https://leetcode.com/problems/design-circular-deque/)      | Circular Doubly                 | é›™ç«¯ O(1) æ“ä½œ        |

## ğŸ”— å»¶ä¼¸é€£çµ

**ç›¸é—œè³‡æ–™çµæ§‹**ï¼š

- **Singly Linked List**ï¼šå–®å‘ç‰ˆæœ¬ï¼Œç©ºé–“æ›´çœ
- **LRU Cache**ï¼šDoubly + HashMap çš„ç¶“å…¸æ‡‰ç”¨
- **Deque**ï¼šé›™ç«¯ä½‡åˆ—ï¼Œå¯ç”¨ Doubly å¯¦ä½œ

**å»ºè­°å­¸ç¿’é †åº**ï¼š

1. âœ… Doubly Linked List(ç•¶å‰)
2. â¡ï¸ LRU Cache(æ‡‰ç”¨ Doubly çš„ç¶“å…¸é¡Œ)
3. â¡ï¸ LFU Cache(é€²éšæ‡‰ç”¨)
