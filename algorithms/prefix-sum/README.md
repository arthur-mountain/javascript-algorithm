## **Prefix Sum (前綴和)**

前綴和是一種資料結構或計算技巧，用於快速計算陣列中某段區間的總和。以下是它的主要特性和應用:

## **特性 1: 快速計算子陣列區間和**

假設有一個陣列 `nums` 和對應的前綴和陣列 `prefixSum`:

- `prefixSum[i]` 表示陣列從索引 0 到 i-1 的元素總和:

  ```plaintext
  prefixSum[i] = nums[0] + nums[1] + ... + nums[i-1]
  ```

- 區間 [l, r] 的總和可以用公式快速計算:

  ```plaintext
  區間和 = prefixSum[r+1] - prefixSum[l]
  ```

**舉例**:

```javascript
nums = [2, 3, 1, 4];

// prefixSum[0] = 0 (方便計算)
// prefixSum[i] = prefixSum[i-1] + nums[i-1]
prefixSum = [0, 2, 5, 6, 10]; // prefixSum[i] 是 nums[0] 到 nums[i-1] 的和

// 計算區間 [1, 3] 的總和
sum = prefixSum[4] - prefixSum[1]; // 10 - 2 = 8
```

## **特性 2: 單調遞增性**

`prefixSum` 陣列是單調遞增的，因為陣列的每個元素 `prefixSum[i+1] >= prefixSum[i]`:

```plaintext
prefixSum[i+1] = prefixSum[i] + nums[i]
```

這個性質對於二分搜尋特別有用。

## **特性 3: 支援多次區間查詢**

前綴和在進行多次區間查詢時非常高效，因為構建 `prefixSum` 需要 O(n) 時間，而每次查詢僅需 O(1) 時間。

## **特性 4: 可處理多維陣列**

前綴和可以擴展到多維陣列，處理多維區間和。以二維陣列為例:

- 二維前綴和 `prefixSum[i][j]` 表示從左上角 (0, 0) 到當前位置 (i, j) 的總和。

- 區間和公式為:

  ```plaintext
  區間和 = prefixSum[x2][y2] - prefixSum[x1-1][y2] - prefixSum[x2][y1-1] + prefixSum[x1-1][y1-1]
  ```

## **應用場景**

1. **快速查詢區間和**: 如 LeetCode 題目 303、304、209。

2. **二分搜尋結合查詢**: 利用單調性在問題中高效查找。

3. **處理多維區間問題**: 如影像處理、遊戲地圖計算。

4. **累積頻率或統計**: 例如計算累積分布或直方圖。

## **優缺點**

| **優點**                               | **缺點**                                         |
| -------------------------------------- | ------------------------------------------------ |
| 快速查詢區間和，適合多次查詢情境       | 一次性計算耗費 O(n) 時間                         |
| 單調性可結合二分搜尋應用               | 無法處理陣列中的「增量修改」: 需要重新計算前綴和 |
| 可延伸到多維空間，處理更複雜的區間問題 | 需要額外的記憶體儲存前綴和陣列                   |

## **結論**

前綴和是一種簡單但非常高效的工具，

當問題涉及到「多次查詢區間和」或「單調性」時，它可以大幅提升效率，

並常用於數組、區間查詢和算法設計中。
